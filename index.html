<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style type="text/css">
        body { margin: 20px; }
        html, body, button {
            font-family: monospace;
            font-size: 20px;
        }
        table {
            table-layout: auto;
            width: 60%;
            border: 1px solid;
        }
    </style>
    <title>Turing Completer</title>
</head>

<body onload="main();">
    <p>
        Turing Completer<br>
        <div id="solution"></div>
        <div id="tableContainer"></div>
        <br><input type="button" value="RESET" onClick="reset()"/>
        <br><br><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" property="dct:title" rel="dct:type">Turing Completer</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://github.com/marksilverman/spiromaniac" property="cc:attributionName" rel="cc:attributionURL">Mark Silverman</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
    </p>

<script>

var solutionElement = document.getElementById("solution");
function add(info) { solutionElement.innerHTML += info; }
function resetSolution() { solutionElement.innerHTML = ""; }

function addFilters(filters)
{
    var row = document.createElement("tr");
    for (const [desc, test] of filters)
    {
        var id = desc.replace(/ /g, '_');

        var checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = id;
        checkbox.onchange = function(){ refresh() };

        var label = document.createElement("label");
        label.htmlFor = id;
        label.textContent = desc;

        var cell = document.createElement("td");
        cell.appendChild(checkbox);
        cell.appendChild(label);

        row.appendChild(cell);
        filterList.push([ checkbox, test ]);
    }
    filterTable.appendChild(row);
}

var filterList = [ ];
var filterTable = document.createElement("table");
document.getElementById("tableContainer").appendChild(filterTable);

addFilters([ [ "blue is smallest", "b < y && b < p" ],
             [ "yellow is smallest", "y < b && y < p" ],
             [ "purple is smallest", "p < b && p < y" ] ]);

addFilters([ [ "blue is largest", "b > y && b > p" ],
             [ "yellow is largest", "y > b && y > p" ],
             [ "purple is largest", "p > b && p > y" ] ]);

addFilters([ [ "yellow < 4", "y < 4" ],
             [ "yellow == 4", "y == 4" ],
             [ "yellow > 4", "y > 4" ] ]);

addFilters([ [ "yellow + blue < 6", "(y + b) < 6" ],
             [ "yellow + blue == 6", "(y + b) == 6" ],
             [ "yellow + blue > 6", "(y + b) > 6" ] ]);

             addFilters([ [ "blue < yellow", "b < y" ], [ "blue = yellow", "b == y" ], [ "blue > yellow", "b > y" ] ]);
addFilters([ [ "yellow < purple", "y < p" ], [ "yellow = purple", "y == p" ], [ "yellow > purple", "y > p" ] ]);
addFilters([ [ "blue < purple", "b < p" ], [ "blue = purple", "b == p" ], [ "blue > purple", "b > p" ] ]);

addFilters([ [ "ascending", "b < y && y < p" ],
             [ "descending", "b > y && y > p" ],
             [ "no order", "!(b < y && y < p) && !(b > y && y > p)" ] ]);

addFilters([ [ "blue is even", "b % 2 == 0" ], [ "blue is odd", "b % 2 != 0" ] ]);
addFilters([ [ "total is even", "(b + y + p) % 2 == 0" ], [ "total is odd", "(b + y + p) % 2 != 0" ] ]);

addFilters([ [ "no pairs", "b != y && y != p" ], [ "one pair", "(b == y && y != p) || (y == p && p != b)" ] ]);

addFilters([ [ "more evens", "((b % 2 + y % 2 + p % 2) < 2)" ], [ "more odds", "((b % 2 + y % 2 + p % 2) >= 2)" ] ]);

addFilters([ [ "no evens", "evenCount(b, y, p) == 0" ],
             [ "one even", "evenCount(b, y, p) == 1" ],
             [ "two evens", "evenCount(b, y, p) == 2" ] ]);

addFilters([ [ "no odds", "oddCount(b, y, p) == 0" ],
             [ "one odd", "oddCount(b, y, p) == 1" ],
             [ "two odd", "oddCount(b, y, p) == 2" ] ]);

// [blueLT3, blueEQ3, blueGT3] = createFilter("blueLT3", "blue < 3", "blueEQ3", "blue == 3", "blueGT3", "blue > 3");
// [yellowLT3, yellowEQ3, yellowGT3] = createFilter("yellowLT3", "yellow < 3", "yellowEQ3", "yellow == 3", "yellowGT3", "yellow > 3");
// [purpleLT3, purpleEQ3, purpleGT3] = createFilter("purpleLT3", "purple < 3", "purpleEQ3", "purple == 3", "purpleGT3", "purple > 3");

// [blueLT4, blueEQ4, blueGT4] = createFilter("blueLT4", "blue < 4", "blueEQ4", "blue == 4", "blueGT4", "blue > 4");
// [yellowLT4, yellowEQ4, yellowGT4] = createFilter("yellowLT4", "yellow < 4", "yellowEQ4", "yellow == 4", "yellowGT4", "yellow > 4");
// [purpleLT4, purpleEQ4, purpleGT4] = createFilter("purpleLT4", "purple < 4", "purpleEQ4", "purple == 4", "purpleGT4", "purple > 4");

// [byLT6, byEQ6, byGT6] = createFilter("byLT6", "blue + yellow < 6", "byEQ6", "blue + yellow == 6", "byGT6", "blue + yellow > 6");

// [yellowEven, yellowOdd] = createFilter("yellowEven", "yellow is even", "yellowOdd", "yellow is odd");
// [blueEven, blueOdd] = createFilter("blueEven", "blue is even", "blueOdd", "blue is odd");
// [purpleEven, purpleOdd] = createFilter("purpleEven", "purple is even", "purpleOdd", "purple is odd");

var solution = [];
for (let b = 1; b <= 5; b++)
{
    for (let y = 1; y <= 5; y++)
    {
        for (let p = 1; p <= 5; p++)
        {
            var tuple = { };
            tuple.blue = b;
            tuple.yellow = y;
            tuple.purple = p;
            solution.push(tuple);
        }
    }
}

function reset()
{
    for (const input of document.getElementsByTagName('input'))
        if (input.type == "checkbox") input.checked = false;
    refresh();
}

function evenCount(b, y, p)
{
    var count = 0;
    if (b % 2 == 0) count++;
    if (y % 2 == 0) count++;
    if (p % 2 == 0) count++;
    return count;
}

function oddCount(b, y, p)
{
    return 3 - evenCount(b, y, p);
}

function refresh()
{
    resetSolution();
    var prev_blue = -1;
    var prev_yellow = 1;
    var count = 0;
    for (const item of solution)
    {
        var include = true;
        var b = item.blue;
        var y = item.yellow;
        var p = item.purple;

        for (const [checkbox, test] of filterList)
            if (checkbox.checked && !eval(test)) include = false;
        
        if (y != prev_yellow)
        {
            if (b != prev_blue)
                add('<br>');
            else
                add(' | ');
        }
        else if (b == prev_blue)
        {
            add(' ');
        }

        if (include)
        {
            count += 1;
            add(b);
            add(y);
            add(p);
        }
        else
            add('...');
        
        prev_blue = b;
        prev_yellow = y;
    }
    add("<br><br>count: " + count);
}
refresh();

</script>
</body>
</html>
